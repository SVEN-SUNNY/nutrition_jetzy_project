<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriJet - AI Nutrition Planner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="hero">
        <div class="hero-content">
            <h1>Your Personalized Nutrition Plan</h1>
            <p>Powered by Machine Learning</p>
            
            <div class="plan-form">
                <form id="nutritionForm">
                    <div class="form-group">
                        <label for="diet">Dietary Preferences</label>
                        <div class="select-wrapper">
                            <select id="diet" multiple required>
                                <option value="vegetarian">Vegetarian</option>
                                <option value="vegan">Vegan</option>
                                <option value="high-protein">High Protein</option>
                                <option value="low-carb">Low Carb</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="goal">Health Goal</label>
                        <div class="select-wrapper">
                            <select id="goal" required>
                                <option value="weight-loss">Weight Loss</option>
                                <option value="muscle-gain">Muscle Gain</option>
                                <option value="general-health">General Health</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="cta-button">
                        <span class="button-text">Generate Plan</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </form>
            </div>
        </div>
    </header>

    <div id="loader" class="loader hidden">
        <div class="spinner"></div>
        <p>Analyzing your profile with AI...</p>
    </div>

    <section id="resultSection" class="result-section hidden">
        <div class="result-card">
            <h2>Your AI-Generated Plan</h2>
            
            <div class="plan-details">
                <div class="meal-card breakfast">
                    <h3><i class="fas fa-sun"></i> Breakfast</h3>
                    <p id="breakfastMeal">Loading...</p>
                    <div class="nutrition-facts">
                        <span class="calories"><i class="fas fa-fire"></i> <span id="breakfastCalories">0</span> kcal</span>
                        <span class="protein"><i class="fas fa-dumbbell"></i> <span id="breakfastProtein">0</span>g protein</span>
                    </div>
                </div>

                <!-- Repeat for Lunch and Dinner -->
            </div>

            <div class="macros-summary">
                <h3><i class="fas fa-chart-pie"></i> Daily Macros</h3>
                <div class="macros-grid">
                    <div class="macro-item">
                        <div class="macro-label">Protein</div>
                        <div class="macro-value" id="totalProtein">0g</div>
                    </div>
                    <!-- Add Carbs and Fats similarly -->
                </div>
            </div>
        </div>
    </section>

    <script>
        const API_URL = 'https://nutrition-jetzy-backend.onrender.com/plan'; 
        
        document.getElementById('nutritionForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const loader = document.getElementById('loader');
            const resultSection = document.getElementById('resultSection');
            
            loader.classList.remove('hidden');
            resultSection.classList.add('hidden');

            try {
                const formData = {
                    diet: Array.from(document.querySelectorAll('#diet option:checked'))
                            .map(option => option.value),
                    goal: document.getElementById('goal').value
                };

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) throw new Error('API request failed');
                
                const plan = await response.json();
                updatePlanUI(plan);
                
            } catch (error) {
                showError('Failed to generate plan. Please try again later.');
            } finally {
                loader.classList.add('hidden');
                resultSection.classList.remove('hidden');
            }
        });

        function updatePlanUI(plan) {
            // Update breakfast
            document.getElementById('breakfastMeal').textContent = plan.meals.breakfast;
            document.getElementById('breakfastCalories').textContent = plan.macros.breakfast.calories;
            document.getElementById('breakfastProtein').textContent = plan.macros.breakfast.protein;
            
            // Update totals
            document.getElementById('totalProtein').textContent = `${plan.macros.daily.protein}g`;
            // Update other macros similarly
        }

        function showError(message) {
            const errorEl = document.createElement('div');
            errorEl.className = 'error-message';
            errorEl.innerHTML = `
                <i class="fas fa-exclamation-triangle"></i>
                ${message}
            `;
            document.body.appendChild(errorEl);
            setTimeout(() => errorEl.remove(), 5000);
        }
    </script>
</body>
</html>
